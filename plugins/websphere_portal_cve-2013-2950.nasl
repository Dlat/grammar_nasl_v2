#
# (C) Tenable Network Security, Inc.
#

include("compat.inc");

if (description)
{
  script_id(73386);
  script_version("$Revision: 1.3 $");
  script_cvs_date("$Date: 2014/11/12 21:41:25 $");

  script_cve_id("CVE-2013-2950");
  script_bugtraq_id(60201);
  script_osvdb_id(93727);

  script_name(english:"IBM WebSphere Portal Unspecified HTTP Response Splitting (PM85071)");
  script_summary(english:"Checks for installed patches.");

  script_set_attribute(attribute:"synopsis", value:
"The remote Windows host has web portal software installed that is
affected by an HTTP response splitting vulnerability.");
  script_set_attribute(attribute:"description", value:
"The version of WebSphere Portal on the remote host is affected by an
HTTP response splitting vulnerability. An attacker could insert
arbitrary HTTP headers that could allow the attacker to inject
additional headers in order to manipulate cookies.");
  # https://www-304.ibm.com/connections/blogs/PSIRT/entry/security_bulletin_websphere_portal_vulnerability_to_http_response_splitting_if_home_substitution_enabled_cve_2013_2950?lang=en_us
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?65a35990");
  script_set_attribute(attribute:"see_also", value:"https://www-304.ibm.com/support/docview.wss?uid=swg21638864");
  script_set_attribute(attribute:"solution", value:
"IBM has published APAR PM85071. This fix is included in 6.1.0.x /
6.1.5.x CF26 / 7.0.0.2 CF21 / 8.0.0.x CF05. Refer to IBM's advisory
for more information or a workaround.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:M/Au:S/C:N/I:P/A:N");
  script_set_cvss_temporal_vector("CVSS2#E:F/RL:OF/RC:C");
  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");

  script_set_attribute(attribute:"vuln_publication_date", value:"2013/05/28");
  script_set_attribute(attribute:"patch_publication_date", value:"2013/05/28");
  script_set_attribute(attribute:"plugin_publication_date", value:"2014/04/07");

  script_set_attribute(attribute:"potential_vulnerability", value:"true");
  script_set_attribute(attribute:"plugin_type", value:"local");
  script_set_attribute(attribute:"cpe", value:"cpe:/a:ibm:websphere_portal");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"CGI abuses");

  script_copyright(english:"This script is Copyright (C) 2014 Tenable Network Security, Inc.");

  script_dependencies("websphere_portal_installed.nbin");
  script_require_keys("installed_sw/IBM WebSphere Portal", "Settings/ParanoidReport");
  exit(0);
}

include("websphere_portal_version.inc");

# Workaround is available
if (report_paranoia < 2) audit(AUDIT_PARANOID);

websphere_portal_check_version(
  ranges:make_list(
    "6.1.0.0, 6.1.0.6, CF26",
    "6.1.5.0, 6.1.5.3, CF26",
    "7.0.0.0, 7.0.0.2, CF21",
    "8.0.0.0, 8.0.0.1, CF05"
  ),
  fix:"PM85071",
  severity:SECURITY_NOTE
);
