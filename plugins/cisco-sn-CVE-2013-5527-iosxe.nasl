#TRUSTED a66582fbf7acbbcaeeb2260dc1ff2c32f50e66c09a13a56cedac7f2f4c798e71452e414407911cd89ae03bff4b228b382154d474ad08b461b511ec77d431556d3f409834252ba44ee1224c6f824caa87fedd830cd0ea1aef103c35ea36c03c1adf292bf54c5b0ee2b39d9fdd9d65612e35bd59f444a1e79e1f2c6413d847253f4f98fc7f03bc2f1ebf92b85c0811d4384eb63e91932c5be9882a3b608a63b1da98af1452cb700ca775f3d247faba1c816a68c90e5c634118082c3e1c87c38dabeb05579ea7ba4921b2337b6f884d7564610dc0068b81c4385cc2eb378d5d8086c964a4e423e2320d99172400d80397a0f34fd15b49a5f7fdbd1462013b29bbcfbc845a6b5cea879a535d891ef7081cb79c4f795ddc1fade24123f40d615e37527dca27653abe861ae49e9c86565f7b5521c8a1e6e7a92a72ef897cce20441b4ab8b395f3f2b8428b755f52e403c038d3b053c44d1b08f9dd46eba36dfe2b78ad98e4f4d47e1dc40286e4d422ee208625bcdab3f3578b23a30a327a3d541074dc3720084cd4ff685faee1134a3d7a8f752621310561b1236bd506881b9f98418571e2bdcc759395ba9492bf74e5bbe39ad3dbe11921ba788d0be0e7b2000de627fef62500aa2bfaeffe3679a673e9d5c7241712d006dd14b6495b80112a4a8577f4afebbb54f5928d3f9885dd0193ff41daf648e3e028e3624318cc796be5fbc2
#
# (C) Tenable Network Security, Inc.
#

include("compat.inc");

if (description)
{
  script_id(78825);
  script_version("1.5");
  script_set_attribute(attribute:"plugin_modification_date", value:"2017/05/16");

  script_cve_id("CVE-2013-5527");
  script_bugtraq_id(62904);
  script_osvdb_id(98253);
  script_xref(name:"CISCO-BUG-ID", value:"CSCui21030");

  script_name(english:"Cisco IOS XE OSPF Opaque LSA DoS (CSCui21030)");
  script_summary(english:"Checks the IOS XE version.");

  script_set_attribute(attribute:"synopsis", value:
"The remote device is affected by a denial of service vulnerability.");
  script_set_attribute(attribute:"description", value:
"The remote Cisco device is affected by a denial of service
vulnerability due to improper parsing of certain options in OSPF
link-state advertisement (LSA) type 11 packets. A remote,
unauthenticated attacker, using specially crafted OSPF packets with
unusual options can cause a device reload, resulting in a denial of
service.");
  # http://tools.cisco.com/security/center/content/CiscoSecurityNotice/CVE-2013-5527
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?bc1e0e84");
  script_set_attribute(attribute:"see_also", value:"https://tools.cisco.com/security/center/viewAlert.x?alertId=31201");
  script_set_attribute(attribute:"solution", value:
"Upgrade to the relevant fixed version referenced in Cisco bug ID
CSCui21030.");
  
  script_set_cvss_base_vector("CVSS2#AV:A/AC:M/Au:N/C:N/I:N/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:ND/RL:OF/RC:C");
  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");

  script_set_attribute(attribute:"vuln_publication_date", value:"2013/10/10");
  script_set_attribute(attribute:"patch_publication_date", value:"2014/10/10");
  script_set_attribute(attribute:"plugin_publication_date", value:"2014/11/03");

  script_set_attribute(attribute:"plugin_type", value:"local");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:ios_xe");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"CISCO");

  script_copyright(english:"This script is Copyright (C) 2014-2017 Tenable Network Security, Inc.");

  script_dependencies("cisco_ios_xe_version.nasl");
  script_require_keys("Host/Cisco/IOS-XE/Version");

  exit(0);
}

include("audit.inc");
include("cisco_func.inc");
include("cisco_kb_cmd_func.inc");

# According to the bug ID, the following version are affected :
# 3.3.0S, 3.3.1S, 3.3.2S, 3.9.0S, 3.9.1S

version = get_kb_item_or_exit("Host/Cisco/IOS-XE/Version");

flag = 0;

if (
  version =~ "3\.3\.[0-2]S" ||
  version =~ "3\.9\.[0-1]S"
) flag++;

if (get_kb_item("Host/local_checks_enabled") && flag)
{
  flag = 0;
  buf = cisco_command_kb_item("Host/Cisco/Config/show_ip_osfp", "show ip osfp");
  if (check_cisco_result(buf))
  {
    if ('Routing Process "ospf' >< buf) flag = 1;
  }
  else if (cisco_needs_enable(buf))
  {
    flag = 1;
    override = 1;
  }
}

if(flag)
{
  if (report_verbosity > 0)
  {
    report =
    '\n  Cisco bug ID      : CSCui21030' +
    '\n  Installed release : ' + version +
    '\n';
    security_warning(port:0, extra:report + cisco_caveat(override));
  }
  else security_warning(port:0, extra:cisco_caveat(override));
  exit(0);
}
else audit(AUDIT_HOST_NOT, "affected");
