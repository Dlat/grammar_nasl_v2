#
# (C) Tenable Network Security, Inc.
#

include("compat.inc");

if (description)
{
  script_id(62820);
  script_version("$Revision: 1.7 $");
  script_cvs_date("$Date: 2016/12/07 20:46:55 $");

  script_cve_id("CVE-2012-1709", "CVE-2012-1710");
  script_bugtraq_id(53062, 53082);
  script_osvdb_id(81366, 81367);

  script_name(english:"Oracle Forms Recognition Multiple ActiveX Control Arbitrary File Overwrite Vulnerabilities");
  script_summary(english:"Checks for kill bit on ActiveX controls");

  script_set_attribute(
    attribute:"synopsis",
    value:"The remote host is affected by multiple file overwrite vulnerabilities."
  );
  script_set_attribute(
    attribute:"description",
    value:
"The remote host has an unpatched version of Oracle Forms Recognition
installed that is affected by multiple vulnerable ActiveX controls.  A
flaw in the 'Save()' method of the 'CroScPlt' control, and the
'saveLayout()' method of the 'Sssplt30' control may be exploited to
overwrite arbitrary files on the system.  These vulnerabilities may be
further leveraged to execute arbitrary code on the system."
  );
  script_set_attribute(attribute:"see_also", value:"http://www.zerodayinitiative.com/advisories/ZDI-12-074/");
  script_set_attribute(attribute:"see_also", value:"http://www.zerodayinitiative.com/advisories/ZDI-12-073/");
  script_set_attribute(attribute:"see_also", value:"http://www.oracle.com/technetwork/topics/security/cpuapr2012-366314.html");
  script_set_attribute(attribute:"solution", value:"Apply Oracle Patch 13882540.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:M/Au:N/C:C/I:C/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:F/RL:OF/RC:C");
  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");

  script_set_attribute(attribute:"vuln_publication_date", value:"2012/04/18");
  script_set_attribute(attribute:"patch_publication_date", value:"2012/04/18");
  script_set_attribute(attribute:"plugin_publication_date", value:"2012/11/06");

  script_set_attribute(attribute:"plugin_type", value:"local");
  script_set_attribute(attribute:"cpe", value:"cpe:/a:oracle:fusion_middleware");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Windows");

  script_copyright(english:"This script is Copyright (C) 2012-2016 Tenable Network Security, Inc.");

  script_dependencies('oracle_forms_recognition_installed.nasl');
  script_require_keys('SMB/Oracle_Forms_Recognition/Installed');
  
  exit(0);
}

include('audit.inc');
include('global_settings.inc');
include('misc_func.inc');
include("smb_func.inc");
include("smb_activex_func.inc");

appname = 'Oracle Forms Recognition';
kb_base = "SMB/Oracle_Forms_Recognition/";
report = '';

get_kb_item_or_exit(kb_base + 'Installed');
  
num_installed = get_kb_item_or_exit(kb_base + 'NumInstalls');

for (install_num = 0; install_num < num_installed; install_num++)
{
  ver = get_kb_item_or_exit(kb_base + install_num + '/Version');

  if (ver == '4.1.0.4146')
  {
    ver_ui = get_kb_item_or_exit(kb_base + install_num + '/Version_UI');
    path = get_kb_item_or_exit(kb_base + install_num + '/Path');
    report += '\n  Path              : ' + path +
              '\n  Installed version : ' + ver_ui +
              '\n  Fix               : Patch #13882540\n';
    break;
  }
}

if (report == '') audit(AUDIT_INST_VER_NOT_VULN, appname);

clsids = make_list(
  '{0033DE13-8803-11D4-A9BB-0060087BB5B0}',
  '{018459D0-A6B3-4D9A-97DD-0DF6F9964E86}',
  '{045EAA74-7738-4896-B275-CB8BABE59EC6}',
  '{04BBC414-C99B-11D3-AFD7-00A0C99245F7}',
  '{052C7597-8149-11D3-8EED-00A0C99CE543}',
  '{052C7598-8149-11D3-8EED-00A0C99CE543}',
  '{05B4B9D4-CDC4-4D3D-91BC-6A062C03BD11}',
  '{05BCF03F-47D6-4DB2-8B97-AAB35FE0C1E8}',
  '{07429B03-56DB-4ECE-8B70-0DA3279CC1C0}',
  '{08A99EA5-5270-4B66-B598-E002B022FA20}',
  '{092C4D83-EF50-4541-A3DC-03ED3C62C28A}',
  '{095EC267-00F8-4770-8AC6-2FFA1BE5B921}',
  '{0A581331-B459-11D3-AFC0-0060087BB5B0}',
  '{0AA195AD-75B3-4ED3-A934-2830DEB52C17}',
  '{0AA45D8B-F65F-4022-BCE8-C74D3AB0736A}',
  '{0AD8A455-61CF-11D3-BF50-00902734E7E3}',
  '{0C366750-E5F9-11D3-94FF-00A0C97912D0}',
  '{0CEE0448-332E-4338-BDBF-D47C51426D23}',
  '{0D2576E4-C1B8-11D3-AFCD-00A0C99245F7}',
  '{0D2576E6-C1B8-11D3-AFCD-00A0C99245F7}',
  '{0D2576E7-C1B8-11D3-AFCD-00A0C99245F7}',
  '{0E3AD0BF-AF73-49E8-AC8D-6D080B8EFA0B}',
  '{0E7B8771-2060-11D4-9545-00A0C97912D0}',
  '{0E945A07-382A-11D3-AF3F-00A0C99245F7}',
  '{0F13FF54-6F38-11D3-AF76-00A0C99245F7}',
  '{0F4E0BE9-A3D2-4EDD-BEDF-C2928D736162}',
  '{1297C124-B927-11D3-AFC5-00A0C99245F7}',
  '{1339C0C2-8D0D-11D3-AF95-00A0C99245F7}',
  '{1339C0C4-8D0D-11D3-AF95-00A0C99245F7}',
  '{139082A7-887C-11D4-8060-00902734E7E3}',
  '{139082A9-887C-11D4-8060-00902734E7E3}',
  '{139082AB-887C-11D4-8060-00902734E7E3}',
  '{139082AD-887C-11D4-8060-00902734E7E3}',
  '{16F204F2-6A3C-414D-8F81-56FC3AC042A3}',
  '{18B70A33-F354-4FB3-95AA-A29845923CF9}',
  '{18DFFE60-9DE7-11D4-90D8-00A0C9E77623}',
  '{1A43794A-3D96-4D30-AB08-54C983332D7F}',
  '{1B728AE8-8F8E-11D4-8068-00902734E7E3}',
  '{1BE83B7E-546E-4B23-8F46-046C9C86069F}',
  '{1E2936D5-0096-11D4-B001-00A0C99245F7}',
  '{1E810C5C-5651-4BCF-A072-10076F8457F9}',
  '{1EDAE318-0D15-4EB6-94A6-AAA7599729B3}',
  '{2038478B-3A33-4432-B706-FAE7144D8AC4}',
  '{203D55A5-7FD5-47C7-8D62-917F0B950BDA}',
  '{21FB8A54-887B-11D4-B1E0-0060087BB888}',
  '{21FB8A56-887B-11D4-B1E0-0060087BB888}',
  '{21FB8A57-887B-11D4-B1E0-0060087BB888}',
  '{220544FC-CD4D-4986-B4CE-3262A9FDA28B}',
  '{22166DF3-6BFD-4A88-8A8C-9F625A77B283}',
  '{2386A724-EFA6-11D5-9239-00A0C9E77623}',
  '{254B49C3-B493-11D3-AFC0-00A0C99245F7}',
  '{25D286FE-47A2-4FE8-9A5C-D6D6806971CC}',
  '{26C6EC9E-D1AE-4A2E-BBF1-718E2762AF95}',
  '{278D4A34-7639-11D3-AF7F-00A0C99245F7}',
  '{2823146B-4C3B-4C8F-892D-FDB1F363E6A3}',
  '{2CAD5195-1A81-11D3-8E63-00A0C99CE543}',
  '{2CAD5197-1A81-11D3-8E63-00A0C99CE543}',
  '{2CAD519B-1A81-11D3-8E63-00A0C99CE543}',
  '{2D129199-6489-49DD-A54D-13E6077EA342}',
  '{2D3DA412-BCD1-4967-AD1C-C22EB6F2F6E6}',
  '{2D66F716-9837-4C1C-B582-423EAFACCB6B}',
  '{2DCF2584-6B3D-11D3-AF70-00A0C99245F7}',
  '{2DCF2587-6B3D-11D3-AF70-00A0C99245F7}',
  '{2DD5FCE3-707F-45C7-8186-C1675704055B}',
  '{2E635789-8D34-11D4-8065-00902734E7E3}',
  '{2E7190A4-AD5D-11D3-AFB8-00A0C99245F7}',
  '{2E7190A6-AD5D-11D3-AFB8-00A0C99245F7}',
  '{2F2881BA-1A64-11D3-8EC2-00A0C9E77623}',
  '{2F3423C6-AA40-4F7D-AA88-3C33B83E4335}',
  '{2F63E1E7-7300-4086-8BCB-99885BD785D7}',
  '{30155ACF-0781-4BF6-83E2-4339EDFFDF94}',
  '{3055D904-7A03-4EF2-A3A6-04BD4EEADCCA}',
  '{312AB8A3-1B28-409C-88AE-F22DA5E7EE48}',
  '{32763073-C73D-11D3-AFD4-00A0C99245F7}',
  '{32763075-C73D-11D3-AFD4-00A0C99245F7}',
  '{3335CF47-0C3F-4951-8D68-7A4B09054BB5}',
  '{340F252E-4391-11D3-8EF8-00A0C9E77623}',
  '{340F2534-4391-11D3-8EF8-00A0C9E77623}',
  '{340F2535-4391-11D3-8EF8-00A0C9E77623}',
  '{36A6E9A6-9CE4-11D3-AFA6-00A0C99245F7}',
  '{36A6E9A9-9CE4-11D3-AFA6-00A0C99245F7}',
  '{36A6E9AB-9CE4-11D3-AFA6-00A0C99245F7}',
  '{36A6E9B1-9CE4-11D3-AFA6-00A0C99245F7}',
  '{36A6E9B3-9CE4-11D3-AFA6-00A0C99245F7}',
  '{37307A60-D48B-11D7-BE0A-00A0C9E77623}',
  '{379E9682-291A-4629-8B6B-401B2933083C}',
  '{3818335B-C8E7-11D3-93A8-00104BA2C7D8}',
  '{3827DBAE-52B8-4487-8BE3-BED681507B01}',
  '{38E78A25-8A11-11D4-8062-00902734E7E3}',
  '{38FB4073-F62F-439D-B312-D068AD065B11}',
  '{38FD1107-0AC0-11D4-B00B-00A0C99245F7}',
  '{38FD1108-0AC0-11D4-B00B-00A0C99245F7}',
  '{3A315CC0-77F4-11D3-8EDF-00A0C99CE543}',
  '{3A315CC2-77F4-11D3-8EDF-00A0C99CE543}',
  '{3A315CC3-77F4-11D3-8EDF-00A0C99CE543}',
  '{3A8C5F64-AD5C-11D3-AFB8-00A0C99245F7}',
  '{3A8C5F66-AD5C-11D3-AFB8-00A0C99245F7}',
  '{3A99F3F1-8F84-4E63-9DEA-D9F0EC3769D8}',
  '{3AB51F56-FEE7-401C-AD1B-0CB64163D270}',
  '{3B5C05D2-39D0-49FC-9FB7-ADD4A43BA864}',
  '{3BEA65C8-3642-4808-9CB2-F4607EA97DF6}',
  '{3E27F2D2-F66D-11D3-97D4-00902734E7B6}',
  '{3E27F2D4-F66D-11D3-97D4-00902734E7B6}',
  '{3E27F2D5-F66D-11D3-97D4-00902734E7B6}',
  '{3E9463F9-B185-41D9-A8A9-05CEE3591A5E}',
  '{40327144-B188-4F28-A86C-C4F31FD6B75C}',
  '{42539263-6687-11D3-AF69-00A0C99245F7}',
  '{434EE8E2-1A86-11D3-8E63-00A0C99CE543}',
  '{4412336D-324D-4ED2-B520-129FD97AF612}',
  '{442A6814-CE96-11D3-AFDB-00A0C99245F7}',
  '{442A6816-CE96-11D3-AFDB-00A0C99245F7}',
  '{442A6817-CE96-11D3-AFDB-00A0C99245F7}',
  '{447805A3-DEE2-11D3-BFCE-00902734E7E3}',
  '{447805A4-DEE2-11D3-BFCE-00902734E7E3}',
  '{447805A7-DEE2-11D3-BFCE-00902734E7E3}',
  '{4613FE25-8884-11D3-AF8F-00A0C99245F7}',
  '{46C6C2E3-FF39-4CA9-83FD-9D51B54CAF2B}',
  '{484FC025-106D-11D4-97EC-00902734E7B6}',
  '{488D0248-3BCE-4E75-B08B-31716B688320}',
  '{48C87DAC-47EB-4506-98F2-542193D4C5DA}',
  '{48EE547E-7010-11D3-8ED8-00A0C99CE543}',
  '{4991085B-E8A9-11D5-922F-00A0C9E77623}',
  '{4A64562C-F4B9-4AE2-AF8F-9F42C31FC37D}',
  '{4B01A272-40DE-4DD8-9AD4-DA3E16D50A14}',
  '{4C58EA55-848D-11D4-805C-00902734E7E3}',
  '{4C58EA57-848D-11D4-805C-00902734E7E3}',
  '{4C58EA59-848D-11D4-805C-00902734E7E3}',
  '{4C5E8344-F6A4-11D3-AFF8-00A0C99245F7}',
  '{4C5E8345-F6A4-11D3-AFF8-00A0C99245F7}',
  '{4CB09394-993D-4F50-92ED-D761BA624C6E}',
  '{4DCA1D2E-87CB-11D4-A9BB-0060087BB5B0}',
  '{4EE4156B-C4F9-11D3-A941-0060087BB5B0}',
  '{4EE4156D-C4F9-11D3-A941-0060087BB5B0}',
  '{4F3C8495-B460-11D3-AFC0-0060087BB5B0}',
  '{4F3C8496-B460-11D3-AFC0-0060087BB5B0}',
  '{4FFF086A-B814-4B12-BA20-4945D52CD1AB}',
  '{50AD61D6-6B4D-11D3-8ED2-00A0C99CE543}',
  '{50AD61D7-6B4D-11D3-8ED2-00A0C99CE543}',
  '{50FEA354-678A-4974-82BB-89FDA8DCB160}',
  '{520C9C3A-6085-4C67-88EE-9205C3D457AD}',
  '{5300E602-59EC-11D3-AF54-00A0C99245F7}',
  '{5300E605-59EC-11D3-AF54-00A0C99245F7}',
  '{5300E607-59EC-11D3-AF54-00A0C99245F7}',
  '{5300E609-59EC-11D3-AF54-00A0C99245F7}',
  '{5300E60B-59EC-11D3-AF54-00A0C99245F7}',
  '{5300E60D-59EC-11D3-AF54-00A0C99245F7}',
  '{53CF415E-1A80-11D3-8E63-00A0C99CE543}',
  '{53CF4161-1A80-11D3-8E63-00A0C99CE543}',
  '{5436BC25-B5B4-4A55-BD5E-0C104480CA22}',
  '{54415061-E7DD-11D5-9229-00A0C9E77623}',
  '{54538886-24B6-4DBB-85A2-EEF43C2D307D}',
  '{546EC908-63FB-11D4-A99F-0060087BB5B0}',
  '{54BD615F-9DAE-4E2A-99D5-9E01CF5D2606}',
  '{5515D35C-24DE-42C9-BEDC-416ADC179700}',
  '{57A4D121-3773-4CDD-87C1-89BDAC207826}',
  '{57C4B07E-D168-49BE-AA01-CDE483EA7625}',
  '{59074121-3574-11D4-9083-00A0C9E77623}',
  '{5A49C6D4-0680-11D5-80DD-00902734E7E3}',
  '{5A8E7724-DE07-11D3-9014-00A0C9E77623}',
  '{5BAACA34-87DE-11D4-805F-00902734E7E3}',
  '{5BAACA38-87DE-11D4-805F-00902734E7E3}',
  '{5C899D15-DF08-11D3-BFCE-00902734E7E3}',
  '{5D9E8A56-C7F4-4476-8E73-E1F64D4796BB}',
  '{5DD4CD13-254A-11D3-8E71-00A0C99CE543}',
  '{5E4E6B14-8D11-11D3-AF95-00A0C99245F7}',
  '{5E4E6B16-8D11-11D3-AF95-00A0C99245F7}',
  '{5F4F1664-8550-11D4-89D4-00A0C98395B4}',
  '{5F70B249-1292-4CF5-8F56-A0FA9B837A16}',
  '{5F72EA01-D5B4-11D4-A9E4-0060087BB5B0}',
  '{6053AEA8-91A6-4AB0-916D-11C1807D372C}',
  '{60E79BC2-7E55-4AE1-B5BA-B5C68012BB11}',
  '{60F8711C-7746-11D4-89C4-00A0C98395B4}',
  '{61003195-D879-11D3-900A-00A0C9E77623}',
  '{61003198-D879-11D3-900A-00A0C9E77623}',
  '{610031A9-D879-11D3-900A-00A0C9E77623}',
  '{61641D97-F9AC-4A68-8C9A-2D476201F0C6}',
  '{63482B82-48D3-40B6-B571-0DBB360A0706}',
  '{64017E31-7289-11D3-BF69-00902734E7E3}',
  '{66298AC8-60C6-48BE-A9FB-44DD28A3F8BA}',
  '{662E1CD3-2235-11D3-8E6C-00A0C99CE543}',
  '{66A57A31-63B9-11D4-A99F-0060087BB5B0}',
  '{6719F12E-1F14-11D3-8E6A-00A0C99CE543}',
  '{6719F130-1F14-11D3-8E6A-00A0C99CE543}',
  '{6719F131-1F14-11D3-8E6A-00A0C99CE543}',
  '{67FC3D49-82FE-47EF-9C8A-470257225CA5}',
  '{6820C0F1-F842-11D3-9514-00A0C97912D0}',
  '{689E87D9-0971-4689-8DEE-99E3E7D53CF7}',
  '{69FE1EF4-DEDB-11D3-BFCE-00902734E7E3}',
  '{6ABB9003-48F8-11CF-AC42-0040332ED4E5}',
  '{6B1466E1-9AC5-11D3-94A4-000000000000}',
  '{6B1466E2-9AC5-11D3-94A4-000000000000}',
  '{6C70FD5D-B51E-11D2-916E-0090272FD709}',
  '{6C9A4C7E-BFD2-4ADA-BF7B-B8C7BDDB6D6D}',
  '{6DCDF801-4868-4212-BE59-A773519F8B92}',
  '{6EBEF8A0-7D6A-4AB1-A3F4-5C55E30E5A60}',
  '{6F3F8D7D-0CB0-4115-8C74-CD8D86D35E7C}',
  '{6F492F93-E64A-4DF9-AB96-69D0EA84C72C}',
  '{6F669D44-2D68-4B2B-8A25-A7C5F56A7D99}',
  '{710842EE-2D80-4220-B945-55CAFADB432D}',
  '{7265FD0F-8220-403A-A837-BEDD39502554}',
  '{72A18708-3ABF-4856-A43C-A090362EE366}',
  '{72CE19D5-CA63-11D3-8F57-00A0C99CE543}',
  '{73386DC9-AEB5-4471-AECF-1AE9D4AB2293}',
  '{742DBA44-6851-4532-A221-A348E48E3F47}',
  '{746BA427-96E8-4FFF-A9A4-6E942F1C027A}',
  '{75B2226F-74E2-4877-8179-E3D81E02CD7A}',
  '{75ED713A-0F59-4608-A946-3B1E5EDBE006}',
  '{762A3924-BDF4-11D3-AFCB-00A0C99245F7}',
  '{762B8F65-B913-11D3-AFC5-0060087BB5B0}',
  '{762B8F66-B913-11D3-AFC5-0060087BB5B0}',
  '{7700EBE9-8451-4159-9812-F8B3037A0084}',
  '{77F99867-4C30-477B-8D50-53B7E2D30211}',
  '{789AC6A8-FCFC-11D4-80D4-00902734E7E3}',
  '{78B74BC1-D974-11D3-97B8-00902734E7B6}',
  '{79E93CD5-6DD6-11D4-B1C3-0060087BB888}',
  '{79E93CD6-6DD6-11D4-B1C3-0060087BB888}',
  '{79E93CD7-6DD6-11D4-B1C3-0060087BB888}',
  '{79E93CD8-6DD6-11D4-B1C3-0060087BB888}',
  '{79E93CD9-6DD6-11D4-B1C3-0060087BB888}',
  '{79E93CDA-6DD6-11D4-B1C3-0060087BB888}',
  '{7B971145-724F-11D3-AF7B-00A0C99245F7}',
  '{7C7406F4-D8B5-11D3-900A-00A0C9E77623}',
  '{7D18AFF2-F77A-4194-88A1-7CF3B2315CC4}',
  '{7D460D21-D964-41BC-9A95-10F1FE971879}',
  '{7D893C9E-B84D-4EF3-8A78-AC3F910FA5D6}',
  '{7DE0960B-5284-4430-B129-65E471B3F21E}',
  '{7F0BB367-0D1D-48A0-B00C-FB38B2DC4CF2}',
  '{7FAFE6A5-445B-4DDA-821A-1D0C9DEF7E63}',
  '{806B8A4C-E999-4BD0-AFD8-7E6F70D01879}',
  '{80C52C66-250F-4FB6-BF42-8C91641A632B}',
  '{821F66C5-02A1-41DE-9778-478D945F0F17}',
  '{82CD62CC-A194-4DAA-B8A1-952519A73F9F}',
  '{84AB86D9-4484-41AF-96A3-C72D3A330EA6}',
  '{85268101-4B35-11D4-BE84-00D0B7067BEA}',
  '{85268103-4B35-11D4-BE84-00D0B7067BEA}',
  '{85268104-4B35-11D4-BE84-00D0B7067BEA}',
  '{87235B14-D876-4D16-B8BB-94996C0E8038}',
  '{889403E6-DFB0-11D3-B13C-0060087BB888}',
  '{889403E8-DFB0-11D3-B13C-0060087BB888}',
  '{889403E9-DFB0-11D3-B13C-0060087BB888}',
  '{889403EB-DFB0-11D3-B13C-0060087BB888}',
  '{8897ABAF-861F-4C35-8DF4-14980E66608E}',
  '{89D69E71-D8C4-45AF-9BCF-3DD85D37275D}',
  '{8AA947EA-E07F-48C1-B300-8EB250D53B23}',
  '{8B8BC2EC-63D4-4CB4-B9BD-B3564E564CF5}',
  '{8C3D4AA2-2599-11D2-BAF1-00104B9E0792}',
  '{8C3D4AA4-2599-11D2-BAF1-00104B9E0792}',
  '{8C3D4AA7-2599-11D2-BAF1-00104B9E0792}',
  '{8C7771E3-B694-4358-857F-F9530AD9FB84}',
  '{8C8554AD-D585-4B36-A037-A206BF8B4CB0}',
  '{8D1C31DD-A83D-11D3-94B9-000000000000}',
  '{8F6B7ECD-AEDE-4ED5-8E65-543DA8A0450E}',
  '{90CD519E-AF1F-4EBC-946F-A6D3ED728594}',
  '{9147C683-C015-4DD6-8C90-C3D7F3FC59B0}',
  '{91E0DD75-36C0-11D4-B02E-00A0C99245F7}',
  '{92B9A053-D7B1-11D3-9009-00A0C9E77623}',
  '{92DA4C33-C77D-11D3-AFD4-00A0C99245F7}',
  '{946BFE29-EEC8-420E-BB09-8B6C809002A4}',
  '{95A3EC8E-9E83-11D4-A9C5-0060087BB5B0}',
  '{95A3EC93-9E83-11D4-A9C5-0060087BB5B0}',
  '{95A3EC96-9E83-11D4-A9C5-0060087BB5B0}',
  '{95A3EC98-9E83-11D4-A9C5-0060087BB5B0}',
  '{95A3EC99-9E83-11D4-A9C5-0060087BB5B0}',
  '{96F739B0-39F7-11D3-8E86-00A0C99CE543}',
  '{96F739B4-39F7-11D3-8E86-00A0C99CE543}',
  '{97D817EA-BDF9-42E2-B3B1-FF30EAABE68A}',
  '{98B1F1CE-3E1C-499B-BE66-7DB080F1E102}',
  '{9940D9A4-78D6-11D4-89C5-00A0C98395B4}',
  '{9A713C38-2771-4E8C-A342-B2717545DB63}',
  '{9AFC5CB2-4CFA-11D4-908F-00A0C9E77623}',
  '{9B9E6D53-A367-4D47-A8DA-EC8EDC01B2C7}',
  '{9BBE0683-2FAE-11D3-AF38-00A0C99245F7}',
  '{9BC9964B-800C-4B08-8DF4-2736E95E331C}',
  '{9BD54C29-F601-4EE6-92DA-CB4158DB7A18}',
  '{9C685F35-821B-11D3-8EF0-00A0C99CE543}',
  '{9CF89C9B-34C8-453E-A471-2DA4388A7A77}',
  '{9EC9DB22-DFAF-11D3-B13C-0060087BB888}',
  '{9F67FC60-2D6E-11D4-9076-00A0C9E77623}',
  '{9F75CAEF-50B7-11D3-8F09-00A0C9E77623}',
  '{9F75CAF2-50B7-11D3-8F09-00A0C9E77623}',
  '{9F78B152-EF05-4E2E-9D2A-B57FD1B9B35B}',
  '{A13FEA3B-3CF4-41F0-97AD-3C604129A438}',
  '{A140CE7A-FDC1-444F-88FF-5E9150F074B8}',
  '{A15EEB73-A807-441A-8948-1CECBFB94AFF}',
  '{A220B841-7252-11D3-AF7B-00A0C99245F7}',
  '{A249AFCC-0444-4BE9-A9E5-150B8F283E25}',
  '{A251BA07-A339-11D4-8081-00902734E7E3}',
  '{A2B9752F-00E9-4447-9E07-833449524B10}',
  '{A5323645-0C61-11D4-B00D-00A0C99245F7}',
  '{A568D6C2-D5B2-11D4-9138-00A0C9E77623}',
  '{A568D6D3-D5B2-11D4-9138-00A0C9E77623}',
  '{A5BB7B75-F648-4578-8314-B0314F566324}',
  '{A60CCDF7-624D-4C1C-B459-39E9FC876AC4}',
  '{A7F07D5A-5C5C-4BA4-BEC0-6F1BA669B392}',
  '{A808CD00-E8B8-11D5-922F-00A0C9E77623}',
  '{A917A495-BE23-4C26-86B4-8CD38FA5D600}',
  '{A92C9036-A0E6-11D4-807E-00902734E7E3}',
  '{AA83B0A1-A01D-417A-8591-E9D023385547}',
  '{AABA6B62-867B-47AF-A500-1B8A7828CEA2}',
  '{AAC0667E-66A2-11D3-8EC9-00A0C99CE543}',
  '{AAC06680-66A2-11D3-8EC9-00A0C99CE543}',
  '{AAC06683-66A2-11D3-8EC9-00A0C99CE543}',
  '{ACEE6894-5A17-11D3-AF54-00A0C99245F7}',
  '{AE2D83CF-644E-4585-BD31-9ED577B2588D}',
  '{B03F1867-8B82-456A-AEBC-EAE218ED2457}',
  '{B0D737C8-22F1-11D3-8E6E-00A0C99CE543}',
  '{B0D737C9-22F1-11D3-8E6E-00A0C99CE543}',
  '{B1088917-AF3F-11D4-808D-00902734E7E3}',
  '{B1EFC48B-2032-429D-BE52-D2B43CECAF55}',
  '{B20ABC73-3855-11D3-8F7F-0000861EF01D}',
  '{B20ABC73-3858-11D6-8F7F-0000861EF01D}',
  '{B20ABC74-3855-11D3-8F7F-0000861EF01D}',
  '{B20ABC74-3858-11D6-8F7F-0000861EF01D}',
  '{B20ABC75-3855-11D3-8F7F-0000861EF01D}',
  '{B20ABC75-3858-11D6-8F7F-0000861EF01D}',
  '{B20ABC78-3855-11D3-8F7F-0000861EF01D}',
  '{B20ABC78-3858-11D6-8F7F-0000861EF01D}',
  '{B20ABC7B-3855-11D3-8F7F-0000861EF01D}',
  '{B20ABC7B-3858-11D6-8F7F-0000861EF01D}',
  '{B20ABC7F-3855-11D3-8F7F-0000861EF01D}',
  '{B20ABC7F-3858-11D6-8F7F-0000861EF01D}',
  '{B20ABCF2-3855-11D3-8F7F-0000861EF01D}',
  '{B20ABCF5-3855-11D3-8F7F-0000861EF01D}',
  '{B56100C2-CAFF-423F-BA65-5F1175911CBB}',
  '{B5C6C818-656E-423E-BF1F-C6D621CCB4EA}',
  '{B5F3BE83-6132-11D4-B04C-00A0C99245F7}',
  '{B6503C95-C990-11D3-8F56-00A0C99CE543}',
  '{B6DB59B7-8AD7-11D4-8063-00902734E7E3}',
  '{B6DB59BB-8AD7-11D4-8063-00902734E7E3}',
  '{B707BC89-27AC-11D3-AF30-00A0C99245F7}',
  '{B7085FF9-B391-11D3-AFBF-00A0C99245F7}',
  '{B7808EC0-6097-45E6-BE72-8021B830F7F7}',
  '{B80AE5F7-2CA1-40D9-B114-C8F5288D148C}',
  '{B86BBCC4-F06A-11D5-923B-00A0C9E77623}',
  '{B90FD44A-9D8F-4BF5-A509-D9B39EA3778C}',
  '{BA3919D8-4FB2-11D3-AF46-00A0C99245F7}',
  '{BA3919DA-4FB2-11D3-AF46-00A0C99245F7}',
  '{BA95B054-B669-4972-8E4B-7F3346B5EF8C}',
  '{BBBE394D-8344-4B9B-9626-C0B553E5A1AF}',
  '{BC571B80-31CF-4413-BDD6-501A8B85D465}',
  '{BDA8EEDB-BF85-11D4-809D-00902734E7E3}',
  '{BED2D457-01A6-4A30-83FA-F9D9ABACDF9B}',
  '{BEEBF7F9-A13E-45C2-806C-98466B801B36}',
  '{BF769874-1CA1-11D3-8E65-00A0C99CE543}',
  '{BF769876-1CA1-11D3-8E65-00A0C99CE543}',
  '{BF769878-1CA1-11D3-8E65-00A0C99CE543}',
  '{C05A3F95-E2F2-11D3-AFE6-00A0C99245F7}',
  '{C0C6BD71-D720-47C4-B77A-DD7AF460CA6A}',
  '{C16DFEB6-74DB-11D3-AF7D-00A0C99245F7}',
  '{C1790466-FCF4-4728-B09F-7FE110D0C904}',
  '{C1A996B3-BEFF-4479-8ACE-EE0B162B5668}',
  '{C2C69BE3-D204-4D7D-BB7E-6D3A16377AFA}',
  '{C3D12349-7463-4036-A561-0A378BA008DC}',
  '{C4EF27E0-3946-4900-B312-6A6F6C5FF9A3}',
  '{C529701D-34AE-4199-B143-29B0ACA21807}',
  '{C6AD270A-69C6-4EB0-9779-51BA88D40B22}',
  '{C7192777-8BF4-4634-9ED7-71FCBB09A9DE}',
  '{C7FAE602-6694-11D3-AF69-00A0C99245F7}',
  '{C83FFB2F-DB18-11D2-AB37-444553540000}',
  '{C9DC5660-0C65-11D4-8F9F-00A0C99CE543}',
  '{CB71B515-74FE-41C9-A5AF-E05C82A3A991}',
  '{CD1B4D55-8DF3-11D4-90B7-00A0C9E77623}',
  '{CFAFD861-2497-11D3-AF2E-00A0C99245F7}',
  '{CFAFD864-2497-11D3-AF2E-00A0C99245F7}',
  '{CFAFD865-2497-11D3-AF2E-00A0C99245F7}',
  '{CFAFD866-2497-11D3-AF2E-00A0C99245F7}',
  '{CFAFD867-2497-11D3-AF2E-00A0C99245F7}',
  '{D027B160-E9DD-11D3-8F7F-00A0C99CE543}',
  '{D0DF72D4-DD3A-11D3-97BD-00902734E7B6}',
  '{D10FE9F6-7CB1-41DA-ABE2-6BE4B8F4EA80}',
  '{D1C5E8C5-EFF5-11D2-AB37-D277342F0A68}',
  '{D2A6053D-F1BF-41CC-93AE-A3DED8B37E32}',
  '{D2C3F484-9CE2-11D3-AFA6-00A0C99245F7}',
  '{D2C3F488-9CE2-11D3-AFA6-00A0C99245F7}',
  '{D37B02D3-B4ED-11D2-916E-0090272FD709}',
  '{D4043693-AD4A-4927-98AC-6747C65A9BEB}',
  '{D4AA9A4D-0EDA-45FB-B7B6-8BAA723646D1}',
  '{D4B7D331-0A03-11D4-97E6-00902734E7B6}',
  '{D4B7D333-0A03-11D4-97E6-00902734E7B6}',
  '{D4C05343-BC5F-11D3-AFC6-00A0C99245F7}',
  '{D4C05345-BC5F-11D3-AFC6-00A0C99245F7}',
  '{D4F45B98-F979-11D3-9048-00A0C9E77623}',
  '{D5196A77-4238-4C33-843D-AC9BC42BABD0}',
  '{D68562B6-B6D4-4509-AF66-32917CD61FDC}',
  '{D7234F2E-80D5-4931-88AF-F5CD6D15473B}',
  '{D7B6793C-92D7-49AA-AC04-1C270FA3A7EB}',
  '{D81A5601-3FC7-468C-9081-062283DB0153}',
  '{D8434842-6B40-11D3-AF70-00A0C99245F7}',
  '{D85871E0-9CE0-11D3-AFA6-00A0C99245F7}',
  '{DA45864A-4753-479D-BFA9-88463813033C}',
  '{DBDBF8BA-ADBC-4019-A3AF-E5D88FB185D1}',
  '{DC480A7F-FDAA-45AC-BED4-BAF15E14DB4A}',
  '{DD432765-EA59-11D5-9231-00A0C9E77623}',
  '{DD4D34F4-061F-11D4-B006-00A0C99245F7}',
  '{DE6E372A-97EA-4563-9D99-7127776DB4C4}',
  '{DEFF250D-7A0D-41CA-9487-8FDB35F55B63}',
  '{DF36574E-1846-11D3-8E61-00A0C99CE543}',
  '{DFB60695-8367-4A8C-BDCC-9AC427898F29}',
  '{DFC13E91-89C3-4775-AB42-D0C25CB6CFCA}',
  '{E214583A-B4D9-49EE-A003-51D13050F8EE}',
  '{E2440465-8208-11D3-8EF0-00A0C99CE543}',
  '{E244046B-8208-11D3-8EF0-00A0C99CE543}',
  '{E25B7554-A13E-4E17-A0E6-06E0F810CF87}',
  '{E2A19180-ED48-11D5-9234-00A0C9E77623}',
  '{E3F5AE1A-7FFE-4490-BB42-2235207655FA}',
  '{E4024479-484B-476D-B361-D7A6AC3B69A6}',
  '{E5D77194-AD5B-11D3-AFB8-00A0C99245F7}',
  '{E5E86916-8319-429D-8682-B99F909BE279}',
  '{E72EED83-C28E-11D3-AFCE-00A0C99245F7}',
  '{E76F2650-FCF9-4BCA-98C4-AA9B6DB0861E}',
  '{E789DB6F-AA8C-4052-B2EC-62C0EABF52E0}',
  '{E86A9ABF-6991-42C1-9F54-3C8307894765}',
  '{E8973C1F-A307-4496-BD84-ADE1EDDD28D8}',
  '{E93B4097-BEC3-4456-AF87-544F524F4C3A}',
  '{E990DA91-71F2-11D3-947A-000000000000}',
  '{E990DA93-71F2-11D3-947A-000000000000}',
  '{EAD09C49-E790-420A-883A-5F5ACA99F699}',
  '{ECD00EBF-617D-404D-A29D-051D7A0B5999}',
  '{EDB75764-50B1-4FFB-BBE9-CDD25476A9C6}',
  '{EE3C64BE-4014-4468-9D61-950740D602CF}',
  '{EF47DBCC-1840-4DF3-8222-CC2C4B5909F0}',
  '{EF7699F1-7276-11D3-AF7B-00A0C99245F7}',
  '{F00B7F10-6F02-4842-8234-7D3939E117FF}',
  '{F08E73D4-9CE1-11D3-AFA6-00A0C99245F7}',
  '{F0CC966A-1295-4E82-9A62-E3EB0B31FE09}',
  '{F1C86FF1-F65D-11D3-AFF8-00A0C99245F7}',
  '{F319CB10-4588-11D3-8E9C-00A0C99CE543}',
  '{F319CB12-4588-11D3-8E9C-00A0C99CE543}',
  '{F319CB13-4588-11D3-8E9C-00A0C99CE543}',
  '{F3BC75DE-F1FD-11D2-AB37-8532D3F7D72F}',
  '{F3BC75E1-F1FD-11D2-AB37-8532D3F7D72F}',
  '{F4E4D102-8443-4020-B555-8B52F4811BE7}',
  '{F5DA7AB4-39CE-11D3-AF41-00A0C99245F7}',
  '{F626DD50-8766-4A62-A3D0-C9952858666D}',
  '{F8270307-4CC3-4164-81A4-DF7D6E249FBD}',
  '{F83A073C-5F48-46B1-9932-010122F6158C}',
  '{F866BEED-5129-4100-8A5D-41CC166A58BE}',
  '{F8688C61-FC01-45F9-BA61-CFF7F088B62F}',
  '{F9596B44-4B0E-11D3-8EA4-00A0C99CE543}',
  '{F9596B45-4B0E-11D3-8EA4-00A0C99CE543}',
  '{F9F51003-B48F-11D3-AFC0-00A0C99245F7}',
  '{FB3B63BE-C044-4D00-BE53-F803570FCCA5}',
  '{FBAD55A7-B0EB-4772-8844-9795D2B0CEE3}',
  '{FBD24BC6-EA3D-11D5-9231-00A0C9E77623}',
  '{FC07F764-DE47-11D3-9014-00A0C9E77623}',
  '{FC27B124-BDEE-11D3-AFCB-00A0C99245F7}',
  '{FC4C0E33-5A31-11D3-AF54-00A0C99245F7}',
  '{FC5E564B-C765-46D6-BC63-D6864C04716D}',
  '{FDD08A41-3A02-11D3-8E88-00A0C99CE543}'
);

info = '';

foreach clsid (clsids)
{
  if (report_paranoia > 1 || activex_get_killbit(clsid:clsid) == 0)
  {
    file = activex_get_filename(clsid:clsid);
    if (isnull(file))
    {
      activex_end();
      audit(AUDIT_FN_FAIL, 'activex_get_filename', 'NULL');
    }

    if (!file) continue;

    # Get its version.
    version = activex_get_fileversion(clsid:clsid);
    if (isnull(version))
    {
      activex_end();
      audit(AUDIT_VER_FAIL, file);
    }

    if (version == '') version = 'unknown';

    info =  
      '\n  Class identifier  : ' + clsid +
      '\n  Filename          : ' + file +
      '\n  Installed version : ' + version + '\n';
    break;
  }
}
activex_end();

if (info != '')
{
  if (report_paranoia > 1)
  {
    report =
    '\nThe following vulnerable ActiveX Control belonging to an Oracle Forms' +
    '\nRecognition install was found on the found on the remote host and it' +
    '\nmay indicate that the Oracle Forms Recognition install is missing a' +
    '\npatch :\n' + info +

    '\nNote, though, that Nessus did not check whether the patch was applied' +
    '\nor if the kill bit was set for the control\'s CLSID because of the'+
    '\nReport Paranoia setting in effect when this scan was run.\n' +

    '\nOracle Forms Recognition Install :\n' + report;
  }
  else
  {
    report = 
    '\nThe following ActiveX Control does not have a kill bit set and is' +  
    '\nevidence that Oracle Forms Recognition install is missing a patch :' + 
    '\n' + info +

    '\nOracle Forms Recognition Install :\n' + report;
  }
  if (report_verbosity > 0) security_hole(port:get_kb_item('SMB/transport'), extra:report);
  else security_hole(get_kb_item('SMB/transport'));
  exit(0);
}
else exit(0, 'Patch #13882540 has been applied.');
