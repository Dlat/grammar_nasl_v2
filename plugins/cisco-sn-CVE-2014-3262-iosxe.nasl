#TRUSTED 5b17e4025525794da86eb751838be7c77c5b93d7b25a1804ae808a1505fd2bf9257e542ecf96ea0280cadc35e28e1f44bafe08025416eca762b15b4ebd245f04c9ab02b53d2966e3ebca91013e5eac4a39eecffbed1eeb8c222ee7736498d135d4fb8b9cf2e5f5d429e379b8a26d9a880fb5b1c09e766024f5bd3425f9b23eaae1f3424525cbfad86e814f995d22b0eaadae061e13f07af9ad7b9c0f51842b23548dadaf675e02d11947861c76ed80c8bea5f4aa9a319ecb11442c67a10443e1cb3934ab86fc12db63d142c011f625c0bb665733bb5991555a9bfd1bec47f7b729d4331762147a0e723c56fdc92fe27a8e1d49f5b67951e0da69dcf3921759591f63b438a967cbc964911a9e9cb42d8728ba7b2330716748adf769a4fda06243018ca032ee37bada4cbdb181507d353f5b3f69e9e4fc010b1944a930bf4d34eca4ff997de5f8d63f2170032aa21dffc8f4d5a9fa4707a68991861d5728548f8aee4cb882f1dce044e9acbe6e77cdf88fedb1151ac6d4caa80b0972c807139a33ba73fb6a4a913e71264de7cc1922d5d93f2f9bd1950318baf5eabc0ce9d130d61cc737c7339d1b26357f6255562d1e6293d935eb485b580d5715fff64c194eaf60a6238f41641f11989563a5cdd5ba90fd736bd38b43320782e6dd260e088738171fd81f243305d04d3c6aed2bd85fa7573cec021eace5c2b2ab1bef6dc62e6f
#
# (C) Tenable Network Security, Inc.
#

include("compat.inc");

if (description)
{
  script_id(79250);
  script_version("1.3");
  script_set_attribute(attribute:"plugin_modification_date", value:"2017/05/16");

  script_cve_id("CVE-2014-3262");
  script_bugtraq_id(67399);
  script_osvdb_id(106936);
  script_xref(name:"CISCO-BUG-ID", value:"CSCun73782");

  script_name(english:"Cisco IOS XE LISP ITR DoS (CSCun73782)");
  script_summary(english:"Checks IOS XE version.");

  script_set_attribute(attribute:"synopsis", value:"The remote device is running a vulnerable IOS XE version.");
  script_set_attribute(attribute:"description", value:
"The remote Cisco device is potentially affected by an issue related to
the handling of certain parameters in Locator/ID Separation Protocol
(LISP) control messages sent to the ingress tunnel router (ITR)
component. A remote, unauthenticated attacker could exploit this issue
by sending specially crafted LISP control messages to cause a denial
of service.");
  # http://tools.cisco.com/security/center/content/CiscoSecurityNotice/CVE-2014-3262
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?3a78aa54");
  script_set_attribute(attribute:"see_also", value:"https://tools.cisco.com/security/center/viewAlert.x?alertId=34233");
  script_set_attribute(attribute:"solution", value:
"Upgrade to the relevant fixed version referenced in Cisco bug ID
CSCun73782.");
  script_set_cvss_base_vector("CVSS2#AV:A/AC:M/Au:N/C:N/I:N/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:ND/RL:OF/RC:C");
  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");

  script_set_attribute(attribute:"plugin_type", value:"local");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:ios_xe");

  script_set_attribute(attribute:"vuln_publication_date", value:"2014/05/14");
  script_set_attribute(attribute:"patch_publication_date", value:"2014/05/30");
  script_set_attribute(attribute:"plugin_publication_date", value:"2014/11/14");

  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_copyright(english:"This script is Copyright (C) 2014-2017 Tenable Network Security, Inc.");
  script_family(english:"CISCO");

  script_dependencies("cisco_ios_xe_version.nasl");
  script_require_keys("Host/Cisco/IOS-XE/Version");

  exit(0);
}

include("audit.inc");
include("cisco_func.inc");
include("cisco_kb_cmd_func.inc");

version = get_kb_item_or_exit("Host/Cisco/IOS-XE/Version");
if (version !~ "^3\.10\.[0-2]S$" && version !~ "^3\.11\.[01]S$") audit(AUDIT_INST_VER_NOT_VULN, "Cisco IOS XE software", version);

flag     = FALSE;
override = FALSE;

if (get_kb_item("Host/local_checks_enabled"))
{
  buf = cisco_command_kb_item("Host/Cisco/Config/show_running-config", "show running-config");
  if (check_cisco_result(buf))
  {
    if (preg(multiline:TRUE, pattern:"^\s+ipv[46]\sitr(\s|$)", string:buf))
      flag = TRUE;
  }
  else if (cisco_needs_enable(buf)) override = TRUE;
}

if (!flag && !override) audit(AUDIT_HOST_NOT, "affected");

if (report_verbosity > 0)
{
  report =
    '\n  Cisco Bug ID        : CSCun73782' +
    '\n    Installed release : ' + version + 
    '\n';
  security_note(port:0, extra:report+cisco_caveat(override));
}
else security_note(port:0, extra:cisco_caveat(override));
